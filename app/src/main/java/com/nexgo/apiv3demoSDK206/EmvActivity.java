package com.nexgo.apiv3demoSDK206;

import android.content.Context;
import android.content.DialogInterface;
import android.os.Build;
import android.os.Bundle;
import android.support.v7.app.AlertDialog;
import android.support.v7.app.AppCompatActivity;
import android.text.TextUtils;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;
import android.widget.Toast;

import com.nexgo.apiv3demo.R;
import com.nexgo.common.ByteUtils;
import com.nexgo.common.LogUtils;
import com.nexgo.oaf.apiv3.DeviceEngine;
import com.nexgo.oaf.apiv3.SdkResult;
import com.nexgo.oaf.apiv3.device.pinpad.OnPinPadInputListener;
import com.nexgo.oaf.apiv3.device.pinpad.PinAlgorithmModeEnum;
//import com.nexgo.oaf.apiv3.device.pinpad.PinKeyboardViewModeEnum;
import com.nexgo.oaf.apiv3.device.pinpad.PinPad;
import com.nexgo.oaf.apiv3.device.pinpad.PinPadKeyCode;
import com.nexgo.oaf.apiv3.device.reader.CardInfoEntity;
import com.nexgo.oaf.apiv3.device.reader.CardReader;
import com.nexgo.oaf.apiv3.device.reader.CardSlotTypeEnum;
import com.nexgo.oaf.apiv3.device.reader.OnCardInfoListener;
import com.nexgo.oaf.apiv3.emv.CandidateAppInfoEntity;
import com.nexgo.oaf.apiv3.emv.EmvChannelTypeEnum;
import com.nexgo.oaf.apiv3.emv.EmvDataSourceEnum;
import com.nexgo.oaf.apiv3.emv.EmvHandler;
import com.nexgo.oaf.apiv3.emv.EmvOnlineResultEntity;
import com.nexgo.oaf.apiv3.emv.EmvProcessResultEntity;
import com.nexgo.oaf.apiv3.emv.EmvTransDataEntity;
import com.nexgo.oaf.apiv3.emv.EmvTransFlowEnum;
import com.nexgo.oaf.apiv3.emv.OnEmvProcessListener;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Locale;
import java.util.Map;

public class EmvActivity extends AppCompatActivity implements OnCardInfoListener, OnEmvProcessListener, OnPinPadInputListener {

    private DeviceEngine deviceEngine;
    private EmvHandler emvHandler;
    private String cardNo;
    private String pwdText;
    private TextView pwdTv;
    private AlertDialog pwdAlertDialog;
    private View dv;
    private Context mContext;
//    private CPUCardHandler cpuCardHandler;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_emv);
        mContext = this;
        deviceEngine = ((NexgoApplication) getApplication()).deviceEngine;
        emvHandler = deviceEngine.getEmvHandler("api3demo");
        dv = getLayoutInflater().inflate(R.layout.dialog_inputpin_layout, null);
        pwdTv = (TextView) dv.findViewById(R.id.input_pin);
        pwdAlertDialog = new AlertDialog.Builder(this).setView(dv).create();
        pwdAlertDialog.setCanceledOnTouchOutside(false);

        emvHandler.emvDebugLog(false);
        LogUtils.setDebugEnable(false);



    }

    static List<byte[]> aidList = new ArrayList<>();
    static List<byte[]> ridList = new ArrayList<>();

    static {
        //美国exadigm公司使用
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000031010DF0101009F0902008CDF1105DC4000A800DF1205DC4004F800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF14039F0206DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000032010DF0101009F0902008CDF1105DC4000A800DF1205DC4004F800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF14039F0206DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000041010DF0101009F09020002DF1105FC50B8A000DF1205FC50808800DF130500000000009F1B0400000000DF150400000000DF160163DF170163DF140F9F02065F2A029A039C0195059F3704DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0606A00000002501DF0101009F09020001DF1105C800000000DF1205C800000000DF130500000000009F1B0400000000DF150400000000DF160163DF170163DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000001523010DF0101009F09020001DF1105DC00002000DF1205FCE09CF800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000033010DF0101009F0902008CDF1105DC4000A800DF1205DC4004F800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF14039F0206DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000043060DF0101009F09020002DF1105FC50BCA000DF1205FC50BCF800DF130500000000009F1B0400000000DF150400000000DF160163DF170163DF140F9F02065F2A029A039C0195059F3704DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000042203DF0101009F09020002DF1105FC50BCA000DF1205FC50BCF800DF130500000000009F1B0400000000DF150400000000DF160163DF170163DF140F9F02065F2A029A039C0195059F3704DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000980840DF0101009F0902008CDF1105DC4000A800DF1205DC4004F800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF14039F0206DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000000651010DF0101009F09020200DF1105FC60242800DF1205FC60ACF800DF130500100000009F1B0400000000DF150400000000DF160100DF170100DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));
        aidList.add(ByteUtils.hexString2ByteArray("9F0607A0000001524010DF0101009F09020001DF1105DC00002000DF1205FCE09CF800DF130500100000009F1B0400000000DF150400000000DF160163DF170163DF1801019F7B06000000004000DF2106000000010000DF2006000000030000DF1906000000020000"));

        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220104DF050420201231DF060101DF070101DF0260D0F543F03F2517133EF2BA4A1104486758630DCFE3A883C77B4E4844E39A9BD6360D23E6644E1E071F196DDF2E4A68B4A3D93D14268D7240F6A14F0D714C17827D279D192E88931AF7300727AE9DA80A3F0E366AEBA61778171737989E1EE309DF040103DF0314FDD7139EC7E0C33167FD61AD3CADBD68D66E91C5"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F22010EDF050420201231DF060101DF070101DF028190AA94A8C6DAD24F9BA56A27C09B01020819568B81A026BE9FD0A3416CA9A71166ED5084ED91CED47DD457DB7E6CBCD53E560BC5DF48ABC380993B6D549F5196CFA77DFB20A0296188E969A2772E8C4141665F8BB2516BA2C7B5FC91F8DA04E8D512EB0F6411516FB86FC021CE7E969DA94D33937909A53A57F907C40C22009DA7532CB3BE509AE173B39AD6A01BA5BB85DF040103DF0314A7266ABAE64B42A3668851191D49856E17F8FBCD"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F22010FDF050420201231DF060101DF070101DF0281B0C8D5AC27A5E1FB89978C7C6479AF993AB3800EB243996FBB2AE26B67B23AC482C4B746005A51AFA7D2D83E894F591A2357B30F85B85627FF15DA12290F70F05766552BA11AD34B7109FA49DE29DCB0109670875A17EA95549E92347B948AA1F045756DE56B707E3863E59A6CBE99C1272EF65FB66CBB4CFF070F36029DD76218B21242645B51CA752AF37E70BE1A84FF31079DC0048E928883EC4FADD497A719385C2BBBEBC5A66AA5E5655D18034EC5DF040103DF0314A73472B3AB557493A9BC2179CC8014053B12BAB4"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220110DF050420201231DF060101DF070101DF0281F8CF98DFEDB3D3727965EE7797723355E0751C81D2D3DF4D18EBAB9FB9D49F38C8C4A826B99DC9DEA3F01043D4BF22AC3550E2962A59639B1332156422F788B9C16D40135EFD1BA94147750575E636B6EBC618734C91C1D1BF3EDC2A46A43901668E0FFC136774080E888044F6A1E65DC9AAA8928DACBEB0DB55EA3514686C6A732CEF55EE27CF877F110652694A0E3484C855D882AE191674E25C296205BBB599455176FDD7BBC549F27BA5FE35336F7E29E68D783973199436633C67EE5A680F05160ED12D1665EC83D1997F10FD05BBDBF9433E8F797AEE3E9F02A34228ACE927ABE62B8B9281AD08D3DF5C7379685045D7BA5FCDE58637DF040103DF0314C729CF2FD262394ABC4CC173506502446AA9B9FD"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220197DF050420201231DF060101DF070101DF028190E178FFE834B4B767AF3C9A511F973D8E8505C5FCB2D3768075AB7CC946A955789955879AAF737407151521996DFA43C58E6B130EB1D863B85DC9FFB4050947A2676AA6A061A4A7AE1EDB0E36A697E87E037517EB8923136875BA2CA1087CBA7EC7653E5E28A0C261A033AF27E3A67B64BBA26956307EC47E674E3F8B722B3AE0498DB16C7985310D9F3D117300D32B09DF040103DF0314EBDA522B631B3EB4F4CBFC0679C450139D2B69CD"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220198DF050420201231DF060101DF070101DF0281B0D31A7094FB221CBA6660FB975AAFEA80DB7BB7EAFD7351E748827AB62D4AEECCFC1787FD47A04699A02DB00D7C382E80E804B35C59434C602389D691B9CCD51ED06BE67A276119C4C10E2E40FC4EDDF9DF39B9B0BDEE8D076E2A012E8A292AF8EFE18553470639C1A032252E0E5748B25A3F9BA4CFCEE073038B061837F2AC1B04C279640F5BD110A9DC665ED2FA6828BD5D0FE810A892DEE6B0E74CE8863BDE08FD5FD61A0F11FA0D14978D8CED7DD3DF040103DF0314D4DBA428CF11D45BAEB0A35CAEA8007AD8BA8D71"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220199DF050420201231DF060101DF070101DF0281F8E1740074229FA0D228A9623581D7A322903FB89BA7686712E601FA8AB24A9789186F15B70CCBBE7421B1CB110D45361688135FFD0DB15A3F516BB291D4A123EBF5A06FBF7E1EE6311B737DABB289570A7959D532B25F1DA6758C84DDCCADC049BC764C05391ABD2CADEFFA7E242D5DD06E56001F0E68151E3388074BD9330D6AFA57CBF33946F531E51E0D4902EE235C756A905FB733940E6EC897B4944A5EDC765705E2ACF76C78EAD78DD9B066DF0B2C88750B8AEE00C9B4D4091FA7338449DA92DBFC908FA0781C0128C492DB993C88BA8BB7CADFE238D477F2517E0E7E3D2B11796A0318CE2AD4DA1DB8E54AB0D94F109DB9CAEEFBEFDF040103DF031494790D020F4F692D59289F36451872078005B63B"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C1DF050420201231DF060101DF070101DF028190E69E319C34D1B4FB43AED4BD8BBA6F7A8B763F2F6EE5DDF7C92579A984F89C4A9C15B27037764C58AC7E45EFBC34E138E56BA38F76E803129A8DDEB5E1CC8C6B30CF634A9C9C1224BF1F0A9A18D79ED41EBCF1BE78087AE8B7D2F896B1DE8B7E784161A138A0F2169AD33E146D1B16AB595F9D7D98BE671062D217F44EB68C68640C7D57465A063F6BAC776D3E2DAC61DF040103DF0314DC79D6B5FC879362299BC5A637DAD2E0D99656B8"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C2DF050420201231DF060101DF070101DF0281B0B875002F38BA26D61167C5D440367604AD38DF2E93D8EE8DA0E8D9C0CF4CC5788D11DEA689E5F41D23A3DA3E0B1FA5875AE25620F5A6BCCEE098C1B35C691889D7D0EF670EB8312E7123FCC5DC7D2F0719CC80E1A93017F944D097330EDF945762FEE62B7B0BA0348228DBF38D4216E5A67A7EF74F5D3111C44AA31320F623CB3C53E60966D6920067C9E082B746117E48E4F00E110950CA54DA3E38E5453BD5544E3A6760E3A6A42766AD2284E0C9AFDF040103DF03148E748296359A7428F536ADDA8E2C037E2B697EF6"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C3DF050420201231DF060101DF070101DF0281F8B93182ABE343DFBF388C71C4D6747DCDEC60367FE63CFAA942D7D323E688D0832836548BF0EDFF1EDEEB882C75099FF81A93FA525C32425B36023EA02A8899B9BF7D7934E86F997891823006CEAA93091A73C1FDE18ABD4F87A22308640C064C8C027685F1B2DB7B741B67AB0DE05E870481C5F972508C17F57E4F833D63220F6EA2CFBB878728AA5887DE407D10C6B8F58D46779ECEC1E2155487D52C78A5C03897F2BB580E0A2BBDE8EA2E1C18F6AAF3EB3D04C3477DEAB88F150C8810FD1EF8EB0596866336FE2C1FBC6BEC22B4FE5D885647726DB59709A505F75C49E0D8D71BF51E4181212BE2142AB2A1E8C0D3B7136CD7B7708E4DDF040103DF031412F1790CB0273DC73C6E70784BC24C12E8DB71F6"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C7DF050420201231DF060101DF070101DF028190CD237E34E0299DE48F1A2C94F478FE972896011E1CA6AB462B68FE0F6109C9A97C2DBEEA65932CDE0625138B9F162B92979DAAB019D3B5561D31EB2D4F09F12F927EA8F740CE0E87154965505E2272F69042B15D57CCC7F771919123978283B3CCE524D9715207BF5F5AD369102176F0F7A78A6DEB2BFF0EDCE165F3B14F14D0035B2756861FE03C43396ED002C894A3DF040103DF03146221E0C726BAC8F8AC25F8F93B811D1FFD4C131C"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C8DF050420201231DF060101DF070101DF028190BF0CFCED708FB6B048E3014336EA24AA007D7967B8AA4E613D26D015C4FE7805D9DB131CED0D2A8ED504C3B5CCD48C33199E5A5BF644DA043B54DBF60276F05B1750FAB39098C7511D04BABC649482DDCF7CC42C8C435BAB8DD0EB1A620C31111D1AAAF9AF6571EEBD4CF5A08496D57E7ABDBB5180E0A42DA869AB95FB620EFF2641C3702AF3BE0B0C138EAEF202E21DDF040103DF031433BD7A059FAB094939B90A8F35845C9DC779BD50"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C9DF050420201231DF060101DF070101DF0281B0B362DB5733C15B8797B8ECEE55CB1A371F760E0BEDD3715BB270424FD4EA26062C38C3F4AAA3732A83D36EA8E9602F6683EECC6BAFF63DD2D49014BDE4D6D603CD744206B05B4BAD0C64C63AB3976B5C8CAAF8539549F5921C0B700D5B0F83C4E7E946068BAAAB5463544DB18C63801118F2182EFCC8A1E85E53C2A7AE839A5C6A3CABE73762B70D170AB64AFC6CA482944902611FB0061E09A67ACB77E493D998A0CCF93D81A4F6C0DC6B7DF22E62DBDF040103DF03148E8DFF443D78CD91DE88821D70C98F0638E51E49"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000001529F22015ADF050420201231DF060101DF070101DF028180EDD8252468A705614B4D07DE3211B30031AEDB6D33A4315F2CFF7C97DB918993C2DC02E79E2FF8A2683D5BBD0F614BC9AB360A448283EF8B9CF6731D71D6BE939B7C5D0B0452D660CF24C21C47CAC8E26948C8EED8E3D00C016828D642816E658DC2CFC61E7E7D7740633BEFE34107C1FB55DEA7FAAEA2B25E85BED948893D07DF040103DF0314CC9585E8E637191C10FCECB32B5AE1B9D410B52D"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000001529F22015BDF050420201231DF060101DF070101DF028190D3F45D065D4D900F68B2129AFA38F549AB9AE4619E5545814E468F382049A0B9776620DA60D62537F0705A2C926DBEAD4CA7CB43F0F0DD809584E9F7EFBDA3778747BC9E25C5606526FAB5E491646D4DD28278691C25956C8FED5E452F2442E25EDC6B0C1AA4B2E9EC4AD9B25A1B836295B823EDDC5EB6E1E0A3F41B28DB8C3B7E3E9B5979CD7E079EF024095A1D19DDDF040103DF03144DC5C6CAB6AE96974D9DC8B2435E21F526BC7A60"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000001529F22015CDF050420201231DF060101DF070101DF0281B0833F275FCF5CA4CB6F1BF880E54DCFEB721A316692CAFEB28B698CAECAFA2B2D2AD8517B1EFB59DDEFC39F9C3B33DDEE40E7A63C03E90A4DD261BC0F28B42EA6E7A1F307178E2D63FA1649155C3A5F926B4C7D7C258BCA98EF90C7F4117C205E8E32C45D10E3D494059D2F2933891B979CE4A831B301B0550CDAE9B67064B31D8B481B85A5B046BE8FFA7BDB58DC0D7032525297F26FF619AF7F15BCEC0C92BCDCBC4FB207D115AA65CD04C1CF982191DF040103DF031460154098CBBA350F5F486CA31083D1FC474E31F8"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000001529F22015DDF050420201231DF060101DF070101DF0281F8AD938EA9888E5155F8CD272749172B3A8C504C17460EFA0BED7CBC5FD32C4A80FD810312281B5A35562800CDC325358A9639C501A537B7AE43DF263E6D232B811ACDB6DDE979D55D6C911173483993A423A0A5B1E1A70237885A241B8EEBB5571E2D32B41F9CC5514DF83F0D69270E109AF1422F985A52CCE04F3DF269B795155A68AD2D6B660DDCD759F0A5DA7B64104D22C2771ECE7A5FFD40C774E441379D1132FAF04CDF55B9504C6DCE9F61776D81C7C45F19B9EFB3749AC7D486A5AD2E781FA9D082FB2677665B99FA5F1553135A1FD2A2A9FBF625CA84A7D736521431178F13100A2516F9A43CE095B032B886C7A6AB126E203BE7DF040103DF0314B51EC5F7DE9BB6D8BCE8FB5F69BA57A04221F39B"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000002779F220102DF050420201231DF060101DF070101DF028190E0FFBEE77CEE02ADEE8B4B004D26FB46FAF3CE033E3B874D73D099A966A0657497CEE214E95DF2BF5C9D359A3B10C05CFC9929BEF3070036FD19AE661B173E486CBC9B04E4B2E2D0D8209CAF5C200929FA252A21BD69A9A47488844A1DE5BF8729CE5E5E92117047BDDE9FBE72397FD9FC3BE459D8ED06FD6CADF0AFF39C93CC07B312EE2ACB3D4A15E919F57481CFEFDF0403010001DF0314BAF3652A9F5D0FF45EECECA55B4597B1F53BE283"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000002779F220103DF050420201231DF060101DF070101DF0281B0E51505CCECDD0799BAFE097200DF40FFC2154836B8D67F1E99D4D415F73C04A9FAD73825D32AE5BA77FCD02597393CE4D8104B6010D5A8F28F2B47BB8298DAFD63C9C0BEF62AF937265614E31AE2AB45B60B968DB9DEE55602C169F6C16D4579BAA24765560300A3056F894BA8FFA566D9CCD79453D804B97DA14F21F9C3528ED8B8A368A9FACF05C46C13A9BA020618425EF1ACF6CB4DD5DCD050273502114B59EE90EBD833F70C2F324741E79A19A1DF0403010001DF03140FB60A1BCA38095F3CC578D2DEC95F779840A343"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000002779F220107DF050420201231DF060101DF070101DF0281F8B2CE89726B6B2D1690A0F8CA75CD0B6B1ACDFBE66D53BA00C500BE612FB421423684FF1868554A7722258012E588ED1CD206C67BB2F7598F3CE67F23A888B8ED7421C49A2EBA224DFBD866F62E59338E9F626D0DFD4C9ACC626E42EC0375EE424C93E5DB5773FC98E4AC9FCDEBD0521B15295C797DCABB4679C055AC374A81B245ABF1092A3D46E1CCE10A84F9FC2FC6ED91025121589C9AA68B56B7FBF0D86B4C8E3C9C08406DBB4609BBFC5308F325A8273CB6D36F3E0AF772507BF8A2A9F5A749B5AF98CCEAB2826C2D9C2AB9103B1BAB0DE92099C8072477EC564062AC38184C60DAD298EF352D92DFA041DDE3DB260CE5302B47A7E9DF0403010001DF031444F2C13373A5068B63C9334E914DDE6AB70CE0F1"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000002779F220109DF050420201231DF060101DF070101DF028180F802C308544873AD2225A81943732A4B7CFFA4E3157D17CD5A7723F858F0B11E636D2930FA933778F27C7C49127E0CCA317021CFE8E0F773785EB3FF07587E98CE8ED4FE9E1CA1859F41A9CF2572D8A093C5465F5A29612A45B1700F4DA13814C3D4DF075EAADE8DB4BE4D7B3AE0256F7A0C12E34BD416CAC4F9250C38B7E13BDF0403010001DF0314A2974D6B8F302A923740E2BC6217075202037B8B"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000002779F220140DF050420201231DF060101DF070101DF028180F802C308544873AD2225A81943732A4B7CFFA4E3157D17CD5A7723F858F0B11E636D2930FA933778F27C7C49127E0CCA317021CFE8E0F773785EB3FF07587E98CE8ED4FE9E1CA1859F41A9CF2572D8A093C5465F5A29612A45B1700F4DA13814C3D4DF075EAADE8DB4BE4D7B3AE0256F7A0C12E34BD416CAC4F9250C38B7E13BDF0403010001DF03142015497BE4B86F104BBF337691825EED64E101CA"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000659F220108DF050420201231DF060101DF070101DF028180B74670DAD1DC8983652000E5A7F2F8B35DFD083EE593E5BA895C95729F2BADE9C8ABF3DD9CE240C451C6CEFFC768D83CBAC76ABB8FEA58F013C647007CFF7617BAC2AE3981816F25CC7E5238EF34C4F02D0B01C24F80C2C65E7E7743A4FA8E23206A23ECE290C26EA56DB085C5C5EAE26292451FC8292F9957BE8FF20FAD53E5DF040103DF0314DD36D5896228C8C4900742F107E2F91FE50BC7EE"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000659F22010FDF050420201231DF060101DF070101DF0281909EFBADDE4071D4EF98C969EB32AF854864602E515D6501FDE576B310964A4F7C2CE842ABEFAFC5DC9E26A619BCF2614FE07375B9249BEFA09CFEE70232E75FFD647571280C76FFCA87511AD255B98A6B577591AF01D003BD6BF7E1FCE4DFD20D0D0297ED5ECA25DE261F37EFE9E175FB5F12D2503D8CFB060A63138511FE0E125CF3A643AFD7D66DCF9682BD246DDEA1DF040103DF03142A1B82DE00F5F0C401760ADF528228D3EDE0F403"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000659F220111DF050420201231DF060101DF070101DF0281B0A2583AA40746E3A63C22478F576D1EFC5FB046135A6FC739E82B55035F71B09BEB566EDB9968DD649B94B6DEDC033899884E908C27BE1CD291E5436F762553297763DAA3B890D778C0F01E3344CECDFB3BA70D7E055B8C760D0179A403D6B55F2B3B083912B183ADB7927441BED3395A199EEFE0DEBD1F5FC3264033DA856F4A8B93916885BD42F9C1F456AAB8CFA83AC574833EB5E87BB9D4C006A4B5346BD9E17E139AB6552D9C58BC041195336485DF040103DF0314D9FD62C9DD4E6DE7741E9A17FB1FF2C5DB948BCB"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000659F220113DF050420201231DF060101DF070101DF0281F8A3270868367E6E29349FC2743EE545AC53BD3029782488997650108524FD051E3B6EACA6A9A6C1441D28889A5F46413C8F62F3645AAEB30A1521EEF41FD4F3445BFA1AB29F9AC1A74D9A16B93293296CB09162B149BAC22F88AD8F322D684D6B49A12413FC1B6AC70EDEDB18EC1585519A89B50B3D03E14063C2CA58B7C2BA7FB22799A33BCDE6AFCBEB4A7D64911D08D18C47F9BD14A9FAD8805A15DE5A38945A97919B7AB88EFA11A88C0CD92C6EE7DC352AB0746ABF13585913C8A4E04464B77909C6BD94341A8976C4769EA6C0D30A60F4EE8FA19E767B170DF4FA80312DBA61DB645D5D1560873E2674E1F620083F30180BD96CA589DF040103DF031454CFAE617150DFA09D3F901C9123524523EBEDF3"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201EFDF050420201231DF060101DF070101DF0281F8A191CB87473F29349B5D60A88B3EAEE0973AA6F1A082F358D849FDDFF9C091F899EDA9792CAF09EF28F5D22404B88A2293EEBBC1949C43BEA4D60CFD879A1539544E09E0F09F60F065B2BF2A13ECC705F3D468B9D33AE77AD9D3F19CA40F23DCF5EB7C04DC8F69EBA565B1EBCB4686CD274785530FF6F6E9EE43AA43FDB02CE00DAEC15C7B8FD6A9B394BABA419D3F6DC85E16569BE8E76989688EFEA2DF22FF7D35C043338DEAA982A02B866DE5328519EBBCD6F03CDD686673847F84DB651AB86C28CF1462562C577B853564A290C8556D818531268D25CC98A4CC6A0BDFFFDA2DCCA3A94C998559E307FDDF915006D9A987B07DDAEB3BDF040103DF031421766EBB0EE122AFB65D7845B73DB46BAB65427A"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F1DF050420201231DF060101DF070101DF0281B0A0DCF4BDE19C3546B4B6F0414D174DDE294AABBB828C5A834D73AAE27C99B0B053A90278007239B6459FF0BBCD7B4B9C6C50AC02CE91368DA1BD21AAEADBC65347337D89B68F5C99A09D05BE02DD1F8C5BA20E2F13FB2A27C41D3F85CAD5CF6668E75851EC66EDBF98851FD4E42C44C1D59F5984703B27D5B9F21B8FA0D93279FBBF69E090642909C9EA27F898959541AA6757F5F624104F6E1D3A9532F2A6E51515AEAD1B43B3D7835088A2FAFA7BE7DF040103DF0314D8E68DA167AB5A85D8C3D55ECB9B0517A1A5B4BB"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F3DF050420201231DF060101DF070101DF02819098F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA3DF040103DF0314A69AC7603DAF566E972DEDC2CB433E07E8B01A9A"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F8DF050420201231DF060101DF070101DF028180A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E1DF040103DF0314F06ECC6D2AAEBF259B7E755A38D9A9B24E2FF3DD"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201FADF050420201231DF060101DF070101DF028190A90FCD55AA2D5D9963E35ED0F440177699832F49C6BAB15CDAE5794BE93F934D4462D5D12762E48C38BA83D8445DEAA74195A301A102B2F114EADA0D180EE5E7A5C73E0C4E11F67A43DDAB5D55683B1474CC0627F44B8D3088A492FFAADAD4F42422D0E7013536C3C49AD3D0FAE96459B0F6B1B6056538A3D6D44640F94467B108867DEC40FAAECD740C00E2B7A8852DDF040103DF03145BED4068D96EA16D2D77E03D6036FC7A160EA99C"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201FEDF050420201231DF060101DF070101DF028180A653EAC1C0F786C8724F737F172997D63D1C3251C44402049B865BAE877D0F398CBFBE8A6035E24AFA086BEFDE9351E54B95708EE672F0968BCD50DCE40F783322B2ABA04EF137EF18ABF03C7DBC5813AEAEF3AA7797BA15DF7D5BA1CBAF7FD520B5A482D8D3FEE105077871113E23A49AF3926554A70FE10ED728CF793B62A1DF040103DF03149A295B05FB390EF7923F57618A9FDA2941FC34E0"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220192DF050420201231DF060101DF070101DF0281B0996AF56F569187D09293C14810450ED8EE3357397B18A2458EFAA92DA3B6DF6514EC060195318FD43BE9B8F0CC669E3F844057CBDDF8BDA191BB64473BC8DC9A730DB8F6B4EDE3924186FFD9B8C7735789C23A36BA0B8AF65372EB57EA5D89E7D14E9C7B6B557460F10885DA16AC923F15AF3758F0F03EBD3C5C2C949CBA306DB44E6A2C076C5F67E281D7EF56785DC4D75945E491F01918800A9E2DC66F60080566CE0DAF8D17EAD46AD8E30A247C9FDF040103DF0314429C954A3859CEF91295F663C963E582ED6EB253"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220194DF050420201231DF060101DF070101DF0281F8ACD2B12302EE644F3F835ABD1FC7A6F62CCE48FFEC622AA8EF062BEF6FB8BA8BC68BBF6AB5870EED579BC3973E121303D34841A796D6DCBC41DBF9E52C4609795C0CCF7EE86FA1D5CB041071ED2C51D2202F63F1156C58A92D38BC60BDF424E1776E2BC9648078A03B36FB554375FC53D57C73F5160EA59F3AFC5398EC7B67758D65C9BFF7828B6B82D4BE124A416AB7301914311EA462C19F771F31B3B57336000DFF732D3B83DE07052D730354D297BEC72871DCCF0E193F171ABA27EE464C6A97690943D59BDABB2A27EB71CEEBDAFA1176046478FD62FEC452D5CA393296530AA3F41927ADFE434A2DF2AE3054F8840657A26E0FC617DF040103DF0314C4A3C43CCF87327D136B804160E47D43B60E6E0F"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220195DF050420201231DF060101DF070101DF028190BE9E1FA5E9A803852999C4AB432DB28600DCD9DAB76DFAAA47355A0FE37B1508AC6BF38860D3C6C2E5B12A3CAAF2A7005A7241EBAA7771112C74CF9A0634652FBCA0E5980C54A64761EA101A114E0F0B5572ADD57D010B7C9C887E104CA4EE1272DA66D997B9A90B5A6D624AB6C57E73C8F919000EB5F684898EF8C3DBEFB330C62660BED88EA78E909AFF05F6DA627BDF040103DF0314EE1511CEC71020A9B90443B37B1D5F6E703030F6"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220199DF050420201231DF060101DF070101DF028180AB79FCC9520896967E776E64444E5DCDD6E13611874F3985722520425295EEA4BD0C2781DE7F31CD3D041F565F747306EED62954B17EDABA3A6C5B85A1DE1BEB9A34141AF38FCF8279C9DEA0D5A6710D08DB4124F041945587E20359BAB47B7575AD94262D4B25F264AF33DEDCF28E09615E937DE32EDC03C54445FE7E382777DF040103DF03144ABFFD6B1C51212D05552E431C5B17007D2F5E6D"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C8DF050420201231DF060101DF070101DF0281B0D4D03C0304B3A78E3BDEF36FF7D67D0BF48A240B97B4D02FB9A61F9381733C69C8E9C5E37A838FF1FEC5B9F0818F81381A8AC6793B68E1DFE923DE1023C66A591E69B0E4EB573210D7D91AE0643022B1F9239E5BA067CD1F293A29271352BF83DEC1A1FCAB87E37A219EAA571D4AA45DF8E1771486407BB9CFD3B6AAE13E6E8C3A4A27CF7B498C3D75BC0B8AE929374E9263B5086B949536BEB2FB2B95F551BAFB405E8AE509D67A342465279136407DDF040103DF031475AFDD6CD392394F5647257C8686409C4D3B38C3"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201C9DF050420201231DF060101DF070101DF0281F8C0A03306EBE4A01F0900463C90FCE65BCDAA7CA2A94E1898B88209DE934F8A4373A0B2A725E6D914F49B675773B36239A7F15455FD900DEDF8E8C4E2DA025D926697966972CEDC4C342174810ECE17C926A621FC8B5B63640D78A62A56F8CE09B69DC673119609833C5AC5D0E8D9EBB77CCC5489416A5E774A2B41AE452B11A094306F9E22E76FE7DBBDAAE7EADC626F61C8C6DCBB469349112ADCF277CE9CA1CD575E7CBE81D9B1B86F0C96CDB0EDD206E8FF7F7950CB8AFFDEC0DF503A9FC3406D394CC9D5B80ED2FDA4AFF1EB9AD010E190F68B6B038235F2F7BF3F1511A532F718A9B5C5EEAAE45A21BD0B2A98F904C2BCA77AB5F929DF040103DF0314B1D9B101C226F0008A800B0E996343AFDAACD42D"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F2201CADF050420201231DF060101DF070101DF0281F8C23ECBD7119F479C2EE546C123A585D697A7D10B55C2D28BEF0D299C01DC65420A03FE5227ECDECB8025FBC86EEBC1935298C1753AB849936749719591758C315FA150400789BB14FADD6EAE2AD617DA38163199D1BAD5D3F8F6A7A20AEF420ADFE2404D30B219359C6A4952565CCCA6F11EC5BE564B49B0EA5BF5B3DC8C5C6401208D0029C3957A8C5922CBDE39D3A564C6DEBB6BD2AEF91FC27BB3D3892BEB9646DCE2E1EF8581EFFA712158AAEC541C0BBB4B3E279D7DA54E45A0ACC3570E712C9F7CDF985CFAFD382AE13A3B214A9E8E1E71AB1EA707895112ABC3A97D0FCB0AE2EE5C85492B6CFD54885CDD6337E895CC70FB3255E3DF040103DF03146BDA32B1AA171444C7E8F88075A74FBFE845765F"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000259F220103DF050420201231DF060101DF070101DF028180B0C2C6E2A6386933CD17C239496BF48C57E389164F2A96BFF133439AE8A77B20498BD4DC6959AB0C2D05D0723AF3668901937B674E5A2FA92DDD5E78EA9D75D79620173CC269B35F463B3D4AAFF2794F92E6C7A3FB95325D8AB95960C3066BE548087BCB6CE12688144A8B4A66228AE4659C634C99E36011584C095082A3A3E3DF040103DF03148708A3E3BBC1BB0BE73EBD8D19D4E5D20166BF6C"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220101DF050420201231DF060101DF070101DF028180C696034213D7D8546984579D1D0F0EA519CFF8DEFFC429354CF3A871A6F7183F1228DA5C7470C055387100CB935A712C4E2864DF5D64BA93FE7E63E71F25B1E5F5298575EBE1C63AA617706917911DC2A75AC28B251C7EF40F2365912490B939BCA2124A30A28F54402C34AECA331AB67E1E79B285DD5771B5D9FF79EA630B75DF040103DF0314D34A6A776011C7E7CE3AEC5F03AD2F8CFC5503CC"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220107DF050420201231DF060101DF070101DF028190A89F25A56FA6DA258C8CA8B40427D927B4A1EB4D7EA326BBB12F97DED70AE5E4480FC9C5E8A972177110A1CC318D06D2F8F5C4844AC5FA79A4DC470BB11ED635699C17081B90F1B984F12E92C1C529276D8AF8EC7F28492097D8CD5BECEA16FE4088F6CFAB4A1B42328A1B996F9278B0B7E3311CA5EF856C2F888474B83612A82E4E00D0CD4069A6783140433D50725FDF040103DF0314B4BC56CC4E88324932CBC643D6898F6FE593B172"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220108DF050420201231DF060101DF070101DF0281B0D9FD6ED75D51D0E30664BD157023EAA1FFA871E4DA65672B863D255E81E137A51DE4F72BCC9E44ACE12127F87E263D3AF9DD9CF35CA4A7B01E907000BA85D24954C2FCA3074825DDD4C0C8F186CB020F683E02F2DEAD3969133F06F7845166ACEB57CA0FC2603445469811D293BFEFBAFAB57631B3DD91E796BF850A25012F1AE38F05AA5C4D6D03B1DC2E568612785938BBC9B3CD3A910C1DA55A5A9218ACE0F7A21287752682F15832A678D6E1ED0BDF040103DF031420D213126955DE205ADC2FD2822BD22DE21CF9A8"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000039F220109DF050420201231DF060101DF070101DF0281F89D912248DE0A4E39C1A7DDE3F6D2588992C1A4095AFBD1824D1BA74847F2BC4926D2EFD904B4B54954CD189A54C5D1179654F8F9B0D2AB5F0357EB642FEDA95D3912C6576945FAB897E7062CAA44A4AA06B8FE6E3DBA18AF6AE3738E30429EE9BE03427C9D64F695FA8CAB4BFE376853EA34AD1D76BFCAD15908C077FFE6DC5521ECEF5D278A96E26F57359FFAEDA19434B937F1AD999DC5C41EB11935B44C18100E857F431A4A5A6BB65114F174C2D7B59FDF237D6BB1DD0916E644D709DED56481477C75D95CDD68254615F7740EC07F330AC5D67BCD75BF23D28A140826C026DBDE971A37CD3EF9B8DF644AC385010501EFC6509D7A41DF040103DF03141FF80A40173F52D7D27E0F26A146A1C8CCB29046"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220100DF050420201231DF060101DF070101DF0281A09C6BE5ADB10B4BE3DCE2099B4B210672B89656EBA091204F613ECC623BEDC9C6D77B660E8BAEEA7F7CE30F1B153879A4E36459343D1FE47ACDBD41FCD710030C2BA1D9461597982C6E1BDD08554B726F5EFF7913CE59E79E357295C321E26D0B8BE270A9442345C753E2AA2ACFC9D30850602FE6CAC00C6DDF6B8D9D9B4879B2826B042A07F0E5AE526A3D3C4D22C72B9EAA52EED8893866F866387AC05A1399DF040103DF0314EC0A59D35D19F031E9E8CBEC56DB80E22B1DE130"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220102DF050420201231DF060101DF070101DF0281C0A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C3DF040103DF031433408B96C814742AD73536C72F0926E4471E8E47"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220103DF050420201231DF060101DF070101DF028180C2490747FE17EB0584C88D47B1602704150ADC88C5B998BD59CE043EDEBF0FFEE3093AC7956AD3B6AD4554C6DE19A178D6DA295BE15D5220645E3C8131666FA4BE5B84FE131EA44B039307638B9E74A8C42564F892A64DF1CB15712B736E3374F1BBB6819371602D8970E97B900793C7C2A89A4A1649A59BE680574DD0B60145DF040103DF03145ADDF21D09278661141179CBEFF272EA384B13BB"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220104DF050420201231DF060101DF070101DF028190A6DA428387A502D7DDFB7A74D3F412BE762627197B25435B7A81716A700157DDD06F7CC99D6CA28C2470527E2C03616B9C59217357C2674F583B3BA5C7DCF2838692D023E3562420B4615C439CA97C44DC9A249CFCE7B3BFB22F68228C3AF13329AA4A613CF8DD853502373D62E49AB256D2BC17120E54AEDCED6D96A4287ACC5C04677D4A5A320DB8BEE2F775E5FEC5DF040103DF0314381A035DA58B482EE2AF75F4C3F2CA469BA4AA6C"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220105DF050420201231DF060101DF070101DF028180A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E1DF040103DF031453D04903B496F59544A84309AF169251F2896874"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220105DF050420201231DF060101DF070101DF0281B0B8048ABC30C90D976336543E3FD7091C8FE4800DF820ED55E7E94813ED00555B573FECA3D84AF6131A651D66CFF4284FB13B635EDD0EE40176D8BF04B7FD1C7BACF9AC7327DFAA8AA72D10DB3B8E70B2DDD811CB4196525EA386ACC33C0D9D4575916469C4E4F53E8E1C912CC618CB22DDE7C3568E90022E6BBA770202E4522A2DD623D180E215BD1D1507FE3DC90CA310D27B3EFCCD8F83DE3052CAD1E48938C68D095AAC91B5F37E28BB49EC7ED597DF040103DF0314EBFA0D5D06D8CE702DA3EAE890701D45E274C845"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F220106DF050420201231DF060101DF070101DF0281F8CB26FC830B43785B2BCE37C81ED334622F9622F4C89AAE641046B2353433883F307FB7C974162DA72F7A4EC75D9D657336865B8D3023D3D645667625C9A07A6B7A137CF0C64198AE38FC238006FB2603F41F4F3BB9DA1347270F2F5D8C606E420958C5F7D50A71DE30142F70DE468889B5E3A08695B938A50FC980393A9CBCE44AD2D64F630BB33AD3F5F5FD495D31F37818C1D94071342E07F1BEC2194F6035BA5DED3936500EB82DFDA6E8AFB655B1EF3D0D7EBF86B66DD9F29F6B1D324FE8B26CE38AB2013DD13F611E7A594D675C4432350EA244CC34F3873CBA06592987A1D7E852ADC22EF5A2EE28132031E48F74037E3B34AB747FDF040103DF0314F910A1504D5FFB793D94F3B500765E1ABCAD72D9"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F5DF050420201231DF060101DF070101DF0281F8A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9DF0403010001DF0314C2239804C8098170BE52D6D5D4159E81CE8466BF"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F6DF050420201231DF060101DF070101DF0281E0A25A6BD783A5EF6B8FB6F83055C260F5F99EA16678F3B9053E0F6498E82C3F5D1E8C38F13588017E2B12B3D8FF6F50167F46442910729E9E4D1B3739E5067C0AC7A1F4487E35F675BC16E233315165CB142BFDB25E301A632A54A3371EBAB6572DEEBAF370F337F057EE73B4AE46D1A8BC4DA853EC3CC12C8CBC2DA18322D68530C70B22BDAC351DD36068AE321E11ABF264F4D3569BB71214545005558DE26083C735DB776368172FE8C2F5C85E8B5B890CC682911D2DE71FA626B8817FCCC08922B703869F3BAEAC1459D77CD85376BC36182F4238314D6C4212FBDD7F23D3DF040103DF0314502909ED545E3C8DBD00EA582D0617FEE9F6F684"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F7DF050420201231DF060101DF070101DF02818094EA62F6D58320E354C022ADDCF0559D8CF206CD92E869564905CE21D720F971B7AEA374830EBE1757115A85E088D41C6B77CF5EC821F30B1D890417BF2FA31E5908DED5FA677F8C7B184AD09028FDDE96B6A6109850AA800175EABCDBBB684A96C2EB6379DFEA08D32FE2331FE103233AD58DCDB1E6E077CB9F24EAEC5C25AFDF0403010001DF0314EEB0DD9B2477BEE3209A914CDBA94C1C4A9BDED9"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605A0000000049F2201F9DF050420201231DF060101DF070101DF0281C0A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C3DF040103DF0314336712DCC28554809C6AA9B02358DE6F755164DB"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F220100DF050420201231DF060101DF070101DF0281A09C6BE5ADB10B4BE3DCE2099B4B210672B89656EBA091204F613ECC623BEDC9C6D77B660E8BAEEA7F7CE30F1B153879A4E36459343D1FE47ACDBD41FCD710030C2BA1D9461597982C6E1BDD08554B726F5EFF7913CE59E79E357295C321E26D0B8BE270A9442345C753E2AA2ACFC9D30850602FE6CAC00C6DDF6B8D9D9B4879B2826B042A07F0E5AE526A3D3C4D22C72B9EAA52EED8893866F866387AC05A1399DF040103DF03145D2970E64675727E60460765A8DB75342AE14783"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F220102DF050420201231DF060101DF070101DF0281C0A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C3DF040103DF0314294BE20239AB15245A63BEA46CC6C175A25562D1"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F220105DF050420201231DF060101DF070101DF028180A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E1DF040103DF0314B9A1D65CAFE06B054EDD7EA82597AB85F130E663"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F3DF050420201231DF060101DF070101DF02818094EA62F6D58320E354C022ADDCF0559D8CF206CD92E869564905CE21D720F971B7AEA374830EBE1757115A85E088D41C6B77CF5EC821F30B1D890417BF2FA31E5908DED5FA677F8C7B184AD09028FDDE96B6A6109850AA800175EABCDBBB684A96C2EB6379DFEA08D32FE2331FE103233AD58DCDB1E6E077CB9F24EAEC5C25AFDF0403010001DF03145694B0D278481814A05E12B558CEC1234865AA5D"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F5DF050420201231DF060101DF070101DF0281E0A25A6BD783A5EF6B8FB6F83055C260F5F99EA16678F3B9053E0F6498E82C3F5D1E8C38F13588017E2B12B3D8FF6F50167F46442910729E9E4D1B3739E5067C0AC7A1F4487E35F675BC16E233315165CB142BFDB25E301A632A54A3371EBAB6572DEEBAF370F337F057EE73B4AE46D1A8BC4DA853EC3CC12C8CBC2DA18322D68530C70B22BDAC351DD36068AE321E11ABF264F4D3569BB71214545005558DE26083C735DB776368172FE8C2F5C85E8B5B890CC682911D2DE71FA626B8817FCCC08922B703869F3BAEAC1459D77CD85376BC36182F4238314D6C4212FBDD7F23D3DF040103DF0314F75E8802855C9B14027E517345717E5C3635B91B"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F6DF050420201231DF060101DF070101DF028180A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E1DF040103DF0314E9406B6510C143AB1E9B9D79A3C1DFF8909A347C"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F7DF050420201231DF060101DF070101DF02819098F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA3DF040103DF0314F78113E860F030A872923FCE93E3381C77A42A30"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F8DF050420201231DF060101DF070101DF0281C0A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C3DF040103DF031466469C88E7DC111529C7D379D7938C8DF3E4C25E"));
        ridList.add(ByteUtils.hexString2ByteArray("9F0605B0123456789F2201F9DF050420201231DF060101DF070101DF0281F8A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9DF0403010001DF0314AEACA45480C8834CB0BEBDCC570B7B2B74BB4B79"));
    }

    public void onClick(View view) {
        int retCode;
        switch (view.getId()) {
            case R.id.add_aid:
                retCode = emvHandler.setAidParaList(aidList);
                Toast.makeText(this, "" + retCode ,Toast.LENGTH_SHORT).show();
                break;
            case R.id.add_capk:
                retCode = emvHandler.setCAPKList(ridList);
                Toast.makeText(this, "" + retCode ,Toast.LENGTH_SHORT).show();
                break;
            case R.id.start_pboc:
                startPbocTest();
                break;
            case R.id.cancel_pboc:
                emvHandler.emvProcessCancel();
                break;
        }
    }

    private void startPbocTest() {



        CardReader cardReader = deviceEngine.getCardReader();
        HashSet<CardSlotTypeEnum> slotTypes = new HashSet<>();
        slotTypes.add(CardSlotTypeEnum.ICC1);
        slotTypes.add(CardSlotTypeEnum.RF);
        cardReader.searchCard(slotTypes, 60, this);
        Toast.makeText(EmvActivity.this, getString(R.string.prompt_card), Toast.LENGTH_SHORT).show();
    }

    private CardSlotTypeEnum mExistSlot;

    @Override
    public void onCardInfo(int retCode, CardInfoEntity cardInfo) {
        Log.d("lsp","onCardInfo");
        if (retCode == SdkResult.Success && cardInfo != null) {
            mExistSlot = cardInfo.getCardExistslot();
            EmvTransDataEntity transData = new EmvTransDataEntity();
            transData.setB9C((byte) 0x00);
            // It's  will have a callback if hava not it.
            transData.setTransAmt("000000001800");
            transData.setTermId("00000001");
            transData.setMerId("000000000000001");
            transData.setTransDate(new SimpleDateFormat("yyMMdd", Locale.getDefault()).format(new Date()));
            transData.setTransTime(new SimpleDateFormat("hhmmss", Locale.getDefault()).format(new Date()));
            transData.setTraceNo("00000000");
            if (cardInfo.getCardExistslot() == CardSlotTypeEnum.RF) {
                transData.setProcType(EmvTransFlowEnum.QPASS);
                transData.setIsForceOnline(true);
                transData.setChannelType(EmvChannelTypeEnum.FROM_PICC);
            } else {
                transData.setProcType(EmvTransFlowEnum.FULL);
                transData.setChannelType(EmvChannelTypeEnum.FROM_ICC);
                transData.isSupportEC();
            }
            Log.d("lsp","emvProcess");
            emvHandler.emvProcess(transData, this);


         //   emvHandler.emvDebugLog(true);

        } else {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    Toast.makeText(EmvActivity.this, getString(R.string.prompt_cardiccrf), Toast.LENGTH_SHORT).show();
                }
            });
        }
    }

    @Override
    public void onSwipeIncorrect() {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
            //    Toast.makeText(EmvActivity.this, getString(R.string.swip_again), Toast.LENGTH_SHORT).show();
            }
        });
    }

    @Override
    public void onMultipleCards() {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
              //  Toast.makeText(EmvActivity.this, getString(R.string.search_toomany_cards), Toast.LENGTH_SHORT).show();
            }
        });
    }

    private String leftPad(String str, int size, char padChar) {
        StringBuilder padded = new StringBuilder(str == null ? "" : str);
        while (padded.length() < size) {
            padded.insert(0, padChar);
        }
        return padded.toString();
    }

    @Override
    public void onRequestAmount() {
        Log.d("lsp","onRequestAmount");
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                final EditText et = new EditText(mContext);
                new AlertDialog.Builder(mContext).setTitle(getString(R.string.input_amount))
                        .setView(et)
                        .setPositiveButton(getString(R.string.prompt_enter), new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int which) {
                                String input = et.getText().toString();
                                if ("".equals(input) || !TextUtils.isDigitsOnly(input)) {
                                    Toast.makeText(getApplicationContext(), getString(R.string.prompt_amount_err) + input, Toast.LENGTH_LONG).show();
                                    emvHandler.onSetRequestAmountResponse(null);
                                } else {
                                    emvHandler.onSetRequestAmountResponse(leftPad(input, 12, '0'));
                                }
                            }
                        })
                        .setNegativeButton(getString(R.string.prompt_cancel), new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                emvHandler.onSetRequestAmountResponse(null);
                            }
                        })
                        .show();
            }
        });
    }

    @Override
    public void onSelApp(final List<String> appNameList, List<CandidateAppInfoEntity> appInfoList, boolean isFirstSelect) {
        Log.d("lsp","onSelApp");
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                View dv = getLayoutInflater().inflate(R.layout.dialog_app_list, null);
                final AlertDialog alertDialog = new AlertDialog.Builder(mContext).setView(dv).create();
                ListView lv = (ListView) dv.findViewById(R.id.aidlistView);
                List<Map<String, String>> listItem = new ArrayList<>();
                for (int i = 0; i < appNameList.size(); i++) {
                    Map<String, String> map = new HashMap<>();
                    map.put("appIdx", (i + 1) + "");
                    map.put("appName", appNameList.get(i));
                    listItem.add(map);
                }
                SimpleAdapter adapter = new SimpleAdapter(mContext,
                        listItem,
                        R.layout.app_list_item,
                        new String[]{"appIdx", "appName"},
                        new int[]{R.id.tv_appIndex, R.id.tv_appName});
                lv.setAdapter(adapter);
                lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                    @Override
                    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                        emvHandler.onSetSelAppResponse(position + 1);
                        alertDialog.dismiss();
                        alertDialog.cancel();
                    }
                });
                alertDialog.setCanceledOnTouchOutside(false);
                alertDialog.show();
            }
        });
    }

//
//	@Override
//    public void onAfterFinalSelectedApp() {
//        runOnUiThread(new Runnable() {
//            @Override
//            public void run() {
//                Log.d("huacong", "onAfterFinalSelectedApp mExistSlot:"+ mExistSlot);
//                if(mExistSlot == CardSlotTypeEnum.RF){
//                    byte[] aid = emvHandler.getTlv(new byte[]{0x4F}, EmvDataSourceEnum.FROM_KERNEL);
//                    if(aid != null){
//                        LogUtils.debug("Aid:"+ ByteUtils.byteArray2HexString(aid));
//                        if(ByteUtils.byteArray2HexString(aid).toUpperCase().contains("A0000000043060")){
//                            emvHandler.setTlv(new byte[]{(byte)0x9F,(byte)0x33}, new byte[]{(byte)0xE0,(byte)0x40,(byte)0xC8});
//                            emvHandler.setTlv(new byte[]{(byte)0xDF,(byte)0x81,(byte)0x18}, new byte[]{(byte)0x40});
//                            emvHandler.setTlv(new byte[]{(byte)0xDF,(byte)0x81,(byte)0x19}, new byte[]{(byte)0x40});
//                            Log.d("huacong", "onAfterFinalSelectedApp Maestro contactless");
//                        }
//                        //9f66 set for contactless
//                        emvHandler.setTlv(ByteUtils.hexString2ByteArray("9F66"), ByteUtils.hexString2ByteArray("3600C000"));
//                    }
//                }
//                emvHandler.onSetAfterFinalSelectedAppResponse(true);
//            }
//        });
//    }

    @Override
    public void onConfirmEcSwitch() {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                final AlertDialog alertDialog = new AlertDialog.Builder(mContext)
                        .setTitle(getString(R.string.is_ecash))
                        .setPositiveButton(getString(R.string.yes), new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                emvHandler.onSetConfirmEcSwitchResponse(true);
                            }
                        })
                        .setNegativeButton(getString(R.string.no), new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                emvHandler.onSetConfirmEcSwitchResponse(false);
                            }
                        })
                        .create();
                alertDialog.setCanceledOnTouchOutside(false);
                alertDialog.show();
            }
        });
    }

    @Override
    public void onConfirmCardNo(final CardInfoEntity cardInfo) {
        Log.d("lsp","onConfirmCardNo");

        byte[] track2 = emvHandler.getTlv(new byte[]{(byte)0x57},EmvDataSourceEnum.FROM_KERNEL);
        Log.d("lsp","tag 57:" + ByteUtils.byteArray2HexString(track2));

        byte[] aid = emvHandler.getTlv(new byte[]{(byte)0x84},EmvDataSourceEnum.FROM_KERNEL);
        Log.d("lsp","tag 84:" + ByteUtils.byteArray2HexString(aid));
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                cardNo = cardInfo.getCardNo();
                final AlertDialog alertDialog = new AlertDialog.Builder(mContext)
                        .setTitle(getString(R.string.ensure_cardno))
                        .setMessage(cardNo)
                        .setPositiveButton(getString(R.string.prompt_enter), new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                emvHandler.onSetConfirmCardNoResponse(true);
                            }
                        })
                        .setNegativeButton(getString(R.string.prompt_cancel), new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                emvHandler.onSetConfirmCardNoResponse(false);
                            }
                        })
                        .create();
                alertDialog.setCanceledOnTouchOutside(false);
                alertDialog.show();
                if (Build.MODEL.equals("G870")) {
//            cpuCardHandler.powerOff();
                }
            }
        });
    }

    @Override
    public void onCardHolderInputPin(final boolean isOnlinePin, int leftTimes) {
        Log.d("lsp", "onCardHolderInputPin" );
        byte[] cvm = emvHandler.getTlv(new byte[]{(byte)0x8E}, EmvDataSourceEnum.FROM_CARD);
        Log.d("lsp", "8E: " + ByteUtils.byteArray2HexString(cvm));
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                showInputPin(isOnlinePin);
            }
        });
    }

    @Override
    public void onCertVerify(String certName, String certInfo) {
        Log.d("lsp","onCertVerify");
        byte[] capki = emvHandler.getTlv(new byte[]{(byte)0x8F}, EmvDataSourceEnum.FROM_CARD);
        Log.d("lsp", "8F: " +  ByteUtils.byteArray2HexString(capki));
        emvHandler.onSetCertVerifyResponse(true);
    }

    @Override
    public void onOnlineProc() {
        Log.d("lsp", "onOnlineProc");
        byte[] tvr = emvHandler.getTlv(new byte[]{(byte)0x95}, EmvDataSourceEnum.FROM_CARD);
        Log.d("lsp", "95: " + ByteUtils.byteArray2HexString(tvr));
        byte[] cvr = emvHandler.getTlv(new byte[]{(byte)0x9F,0x34}, EmvDataSourceEnum.FROM_CARD);
        Log.d("lsp", "9F34: " + ByteUtils.byteArray2HexString(cvr));

        EmvOnlineResultEntity emvOnlineResult = new EmvOnlineResultEntity();
        emvOnlineResult.setAuthCode("00");
        emvOnlineResult.setRejCode("00");
        emvOnlineResult.setRecvField55(ByteUtils.hexString2ByteArray("9f360216bf910a92c532631b605c6030309f790a000000088800d3d0b86f"));
        emvHandler.onSetOnlineProcResponse(SdkResult.Success, emvOnlineResult);
    }

    @Override
    public void onReadCardAgain() {

    }

//    @Override
//    public void onAfterFinalSelectedApp() {
//
//    }

//    @Override
//    public void onAfterFinalSelectedApp() {
//
//    }

    @Override
    public void onFinish(final int retCode, EmvProcessResultEntity entity) {
        Log.d("lsp","onFinish");
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                if (retCode == SdkResult.Emv_Qpboc_Online) {
                    showInputPin(true);
                } else {
                    Toast.makeText(EmvActivity.this, retCode + "", Toast.LENGTH_SHORT).show();
                }
//        cpuCardHandler.powerOff();
            }
        });
    }

    @Override
    public void onInputResult(final int retCode, final byte[] data) {
        System.out.println("onInputResult->"+retCode+","+ByteUtils.byteArray2HexStringWithSpace(data));
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                pwdAlertDialog.dismiss();
                if (retCode == SdkResult.Success || retCode == SdkResult.PinPad_No_Pin_Input
                        || retCode == SdkResult.PinPad_Input_Cancel) {
                    if (data != null) {
                        byte[] temp = new byte[8];
                        System.arraycopy(data, 0, temp, 0, 8);
                        emvHandler.setTlv(new byte[]{(byte) 0xdf, (byte) 0x36}, temp);
                    }
                    emvHandler.onSetPinInputResponse(retCode != SdkResult.PinPad_Input_Cancel, retCode == SdkResult.PinPad_No_Pin_Input);
                } else {
                    Toast.makeText(EmvActivity.this, getString(R.string.input_pin_err), Toast.LENGTH_SHORT).show();
                }
            }
        });
    }

    @Override
    public void onSendKey(final byte keyCode) {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                if (keyCode == PinPadKeyCode.KEYCODE_CLEAR) {
                    pwdText = "";
                } else {
                    pwdText += "* ";
                }
                pwdTv.setText(pwdText);
            }
        });
    }

    private void showInputPin(boolean isOnlinPin) {
        pwdText = "";
        pwdAlertDialog.show();
        pwdTv.setText(pwdText);
        PinPad pinPad = deviceEngine.getPinPad();
     //   pinPad.setPinKeyboardViewMode(PinKeyboardViewModeEnum.DEFAULT);
        if (isOnlinPin) {
            pinPad.inputOnlinePin(new int[]{0x00, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b},
                    60, cardNo.getBytes(), 10, PinAlgorithmModeEnum.ISO9564FMT1, this);
        } else {
            pinPad.inputOfflinePin(new int[]{0x00, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b},
                    60, this);
        }
    }
}
